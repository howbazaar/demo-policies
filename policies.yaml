policies:
  - name: tims-demo-security-group
    resource: aws.security-group

  - name: tims-demo-ec2
    resource: aws.ec2

  - name: tims-demo-s3
    resource: aws.s3

  - name: demo-skipped
    resource: ec2
    mode:
      type: cloudtrail
      events:
       - RunInstances

  - name: lambda-created-missing-tag
    resource: aws.lambda
    mode:
      type: cloudtrail
      events:
       - CreateFunction
    filters:
      - "tag:App": absent
       

  - name: tims-demo-accounts
    resource: aws.account
    region: us-east-1

  - name: test-event-1
    resource: ec2
    mode:
      type: cloudtrail
      events:
       - RunInstances
    metadata:
      test: 1

  - name: test-event-2
    resource: ec2
    description: version two of the event
    mode:
      type: cloudtrail
      events:
       - RunInstances
    metadata:
      test: 2

  - name: test-event-3
    resource: ec2
    mode:
      type: cloudtrail
      events:
       - RunInstances
    metadata:
      test: 3
